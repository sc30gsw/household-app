<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HouseHold</title>
<!-- bootstarpのcss読み込み -->
<link rel="stylesheet"
	th:href="@{/webjars/bootstrap/css/bootstrap.min.css}">
<!-- css読み込み -->
<link rel="stylesheet" th:href="@{/css/household/household.css}">
<!-- bootstrapのjs読み込み -->
<script th:src="@{https://code.jquery.com/jquery-3.2.1.slim.min.js}"></script>
<script
	th:src="@{https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js}"></script>
<script
	th:src="@{https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js}"></script>
<!-- fontawesome読み込み -->
<script th:src="@{https://kit.fontawesome.com/7109a52a62.js}"></script>
<!-- Chart.js読み込み -->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
<!-- Chart.jsのdatalabelsの読み込み -->
<script
	src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<!-- jsの読み込み -->
<script th:src="@{/js/household/index.js}"></script>
</head>
<body>
	<div class="wrapper">
		<header class="header">
			<div th:replace="~{layout/householdHeader::householdHeader}"></div>
			<div class="global-menu">
				<ul class="nav-horizontal">
					<li class="global-menu-item"><a class="active" th:href="@{/household/index}"> <i
							class="active-icon fas fa-home"></i>ホーム
					</a></li>
					<li class="global-menu-item"><a class="unactive" th:href="@{/household/detail}">
							<i class="unactive-icon fas fa-chart-pie"></i>家計
					</a></li>
					<li class="global-menu-item"><a class="unactive" href="#">
							<i class="unactive-icon fas fa-chart-bar"></i>予算
					</a></li>
					<li class="global-menu-item"><a class="unactive" href="#">
							<i class="unactive-icon fas fa-coins"></i>資産
					</a></li>
					<li class="global-menu-item"><a class="unactive" href="#">
							<i class="unactive-icon fas fa-cog"></i>設定
					</a></li>
					<li class="global-menu-item"><a class="unactive" href="#">
							<i class="unactive-icon fas fa-ellipsis-h"></i>
					</a></li>
				</ul>
			</div>
		</header>
		<div class="container-large">
			<div class="home">
				<div class="home-col-assets">
					<section class="user-info">
						<section class="total-assets">
							<h1 class="heading-normal"
								th:text="${#calendars.format(#calendars.createNowForTimeZone('Asia/Tokyo'), 'yyyy年MM月')} + 'の状況'"></h1>
							<div th:if="${monthlySum != null}" class="money-label">
								<span class="money-label">収入</span> - <span class="money-label">支出</span>
								= 合計 : <span th:if="${monthlySum >= 0}" class="money-label"
									th:text="${monthlyFormatSum} +' 円'"></span> <span
									th:if="${monthlySum < 0}" class="money-label-minus"
									th:text="${monthlyFormatSum} +' 円'"></span>
							</div>
							<div th:if="${monthlySum == null}" class="money-label">
								<span class="money-label">今月の収支記録が見つかりませんでした</span>
							</div>
							<div th:if="${deposit != null && payment != null}"
								class="pie-size">
								<canvas id="assetPie">
								</canvas>
							</div>
							<div th:if="${deposit == null && payment == null}"
								class="pie-size-default">
								<canvas id="assetPieDefault">
								</canvas>
							</div>
						</section>
					</section>
					<div class="home-manual-info">
						<section class="manual-entry">
							<h2 class="heading-normal">カンタン入力</h2>
							<div class="manual-payment-entry">
								<form th:action="@{/household/payment}" th:object="${form}"
									method="post">
									<div class="category-contents">
										<div class="btn-group btn_l_ctg">
											<a class="btn btn-red dropdown-toggle" href="#" role="button"
												id="dropdownMenuLink" data-toggle="dropdown"
												aria-haspopup="true" aria-expanded="false"> 未分類</a>
											<ul class="dropdown-menu main_menu minus">
												<li class="dropdown-submenu"><a class="c_name"
													data-value="1" href="#">食費</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="1" href="#">食費</a></li>
														<li><a class="m_c_name" data-value="2" href="#">食料品</a></li>
														<li><a class="m_c_name" data-value="3" href="#">外食</a></li>
														<li><a class="m_c_name" data-value="4" href="#">カフェ</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="5" href="#">日用品</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="5" href="#">日用品</a></li>
														<li><a class="m_c_name" data-value="6" href="#">ドラッグストア</a></li>
														<li><a class="m_c_name" data-value="7" href="#">おこづかい</a></li>
														<li><a class="m_c_name" data-value="8" href="#">ペット用品</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="9" href="#">趣味・娯楽</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="9" href="#">趣味・娯楽</a></li>
														<li><a class="m_c_name" data-value="10" href="#">アウトドア</a></li>
														<li><a class="m_c_name" data-value="11" href="#">スポーツ</a></li>
														<li><a class="m_c_name" data-value="12" href="#">映画・音楽・ゲーム</a></li>
														<li><a class="m_c_name" data-value="13" href="#">旅行</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="14" href="#">交際費</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="14" href="#">交際費</a></li>
														<li><a class="m_c_name" data-value="15" href="#">飲み代</a></li>
														<li><a class="m_c_name" data-value="16" href="#">プレゼント代</a></li>
														<li><a class="m_c_name" data-value="17" href="#">冠婚葬祭</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="18" href="#">交通費</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="18" href="#">交通費</a></li>
														<li><a class="m_c_name" data-value="19" href="#">電車</a></li>
														<li><a class="m_c_name" data-value="20" href="#">バス</a></li>
														<li><a class="m_c_name" data-value="21" href="#">タクシー</a></li>
														<li><a class="m_c_name" data-value="22" href="#">飛行機</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="23" href="#">衣服・美容</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="24" href="#">衣服</a></li>
														<li><a class="m_c_name" data-value="25" href="#">クリーニング</a></li>
														<li><a class="m_c_name" data-value="26" href="#">美容院・理髪</a></li>
														<li><a class="m_c_name" data-value="27" href="#">化粧品</a></li>
														<li><a class="m_c_name" data-value="28" href="#">アクセサリー</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="29" href="#">自動車</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="30" href="#">自動車ローン</a></li>
														<li><a class="m_c_name" data-value="31" href="#">道路料金</a></li>
														<li><a class="m_c_name" data-value="32" href="#">ガソリン</a></li>
														<li><a class="m_c_name" data-value="33" href="#">駐車場</a></li>
														<li><a class="m_c_name" data-value="34" href="#">車検・整備</a></li>
														<li><a class="m_c_name" data-value="35" href="#">自動車保険</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="36" href="#">健康・医療</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="37" href="#">フィットネス</a></li>
														<li><a class="m_c_name" data-value="38" href="#">ボディケア</a></li>
														<li><a class="m_c_name" data-value="39" href="#">医療費</a></li>
														<li><a class="m_c_name" data-value="40" href="#">薬</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="41" href="#">教養・教育</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="42" href="#">書籍</a></li>
														<li><a class="m_c_name" data-value="43" href="#">新聞・雑誌</a></li>
														<li><a class="m_c_name" data-value="44" href="#">習い事</a></li>
														<li><a class="m_c_name" data-value="45" href="#">学費</a></li>
														<li><a class="m_c_name" data-value="46" href="#">塾</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="47" href="#">特別な支出</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="48" href="#">家具・家電</a></li>
														<li><a class="m_c_name" data-value="49" href="#">住宅・リフォーム</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="50" href="#">水道・光熱費</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="51" href="#">光熱費</a></li>
														<li><a class="m_c_name" data-value="52" href="#">電気代</a></li>
														<li><a class="m_c_name" data-value="53" href="#">ガス・灯油代</a></li>
														<li><a class="m_c_name" data-value="54" href="#">水道代</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="55" href="#">通信費</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="56" href="#">携帯電話</a></li>
														<li><a class="m_c_name" data-value="57" href="#">固定電話</a></li>
														<li><a class="m_c_name" data-value="58" href="#">インターネット</a></li>
														<li><a class="m_c_name" data-value="59" href="#">放送視聴料</a></li>
														<li><a class="m_c_name" data-value="60" href="#">情報サービス</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="61" href="#">住宅</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="61" href="#">住宅</a></li>
														<li><a class="m_c_name" data-value="62" href="#">家賃・地代</a></li>
														<li><a class="m_c_name" data-value="63" href="#">ローン返済</a></li>
														<li><a class="m_c_name" data-value="64" href="#">管理費・積立金</a></li>
														<li><a class="m_c_name" data-value="65" href="#">地震・火災保険</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="66" href="#">その他</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="66" href="#">その他</a></li>
														<li><a class="m_c_name" data-value="67" href="#">仕送り</a></li>
														<li><a class="m_c_name" data-value="68" href="#">寄付金</a></li>
														<li><a class="m_c_name" data-value="69" href="#">雑費</a></li>
													</ul></li>
												<li class="dropdown-submenu"><a class="c_name"
													data-value="70" href="#">未分類</a>
													<ul class="sub_menu">
														<li><a class="m_c_name" data-value="70" href="#">未分類</a></li>
													</ul></li>
											</ul>
										</div>
										<div class="btn-group btn_m_ctg">
											<a class="btn btn-secondary dropdown-toggle v_m_ctg"
												data-toggle="dropdown" id="js-middle-category-selected">
												未分類 </a>
										</div>
									</div>
									<div class="right-column">
										<input type="hidden" th:field="*{categoryId}"
											th:errorclass="is-invalid"> <input type="text"
											class="payment-amount" placeholder="金額を入力してください"
											th:field="*{payment}" th:errorclass="is-invalid"> <span
											class="payment-unit">円</span>
										<div class="invalid-feedback" th:errors="*{payment}"></div>
									</div>
									<input type="hidden" id="cal-date-input"
										th:field="*{activeDate}">
									<div class="input-date">
										<p class="text-and-icon" id="cal-text"
											data-date-format="yyyy/mm/dd">
											日付 <span id="date-span"></span><i
												class="icon-calendar fas fa-calendar-alt"></i>
										<div id="calendar" class="draw-cal dropdown-menu"></div>
										</p>
									</div>
									<div class="left-column">
										<input type="text" class="align-left"
											placeholder="内容を入力してください(任意)" th:field="*{note}">
									</div>
									<div class="submit-box">
										<input type="submit" name="commit" value="保存する"> <span
											class="easy-flash-message" th:text="${message}"></span>
									</div>
								</form>
							</div>
						</section>
					</div>
				</div>
				<div class="custom-col-home">
					<div class="home-latest">
						<div class="cf-latest">
							<h2 class="heading-normal">最近の入出金</h2>
							<section class="recent-transactions">
								<div class="recent-transactions-table">
									<div th:if="${latestHouseholdList != null}" class="recent-transactions-row" th:each="item: ${latestHouseholdList}">
										<div class="recent-transactions-row-left">
											<div class="recent-transactions-date" th:text="${#dates.format(item.activeDate, 'yyyy/MM/dd')}"></div>
											<div class="recent-transactions-category" th:text="${item.category.categoryCode} + '＞' + ${item.category.subCategoryName}">未分類＞未分類</div>
											<div class="recent-transactions-content" th:text="${item.note}"></div>
											<div th:if="${item.note == null || item.note == ''}" class="recent-trancastions-content">備考はありません</div>
										</div>
										<div th:if="${item.payment != null && item.payment > 0}" class="recent-transactions-amount" th:text="'-' + ${#numbers.formatInteger(item.payment, 3, 'COMMA')} + '円'"></div>
										<div th:if="${item.deposit != null && item.deposit > 0}" class="recent-transactions-amount" th:text="${#numbers.formatInteger(item.deposit, 3, 'COMMA')} + '円'"></div>
									</div>
									<div th:if="${latestHouseholdList == null}" class="recent-transactions-row">
										<h2 class="money-label">最近の入出金はありません</h2>
									</div>
								</div>
							</section>
							<div th:text="${latestFormatDeposit}"></div>
							<a class="pull-right more-link" href="#"> <i
								class="fas fa-arrow-circle-right"></i>履歴の詳細を見る
							</a>
						</div>
					</div>
					<div class="headline">
						<div class="headline-contents">
							<h2 class="heading-normal" th:inline="text">
								[[${#calendars.format(#calendars.createNowForTimeZone('Asia/Tokyo'),
								'M月')} + 'の収支']] <span
									th:text="'(' + ${startDate} + '-' + ${endDate} + ')'"></span>
							</h2>
							<table cellpadding="10px" data-placement="right"
								class="monthly-total-table"
								th:if="${deposit != null && payment != null && monthlyFormatSum != null}">
								<tbody>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月収入</th>
										<td th:text="${deposit} + '円'"></td>
									</tr>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月支出</th>
										<td th:text="${payment} + '円'"></td>
									</tr>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月収支</th>
										<td th:if="${monthlySum >= 0}" th:text="${monthlyFormatSum} + '円'"></td>
										<td th:if="${monthlySum < 0}" class="minus-color" th:text="${monthlyFormatSum} + '円'"></td>
									</tr>
								</tbody>
							</table>
							<table cellpadding="10px" data-placement="right"
								class="monthly-total-table"
								th:if="${deposit == null && paymant == null && monthlyFormatSum == null}">
								<tbody>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月収入</th>
										<td>¥0円</td>
									</tr>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月支出</th>
										<td>¥0円</td>
									</tr>
									<tr class="monthly-total">
										<th class="monthly-total-head">当月収支</th>
										<td class="minus">¥0円</td>
									</tr>
								</tbody>
							</table>
							<a class="pull-right more-link" href="#"> <i
								class="fas fa-arrow-circle-right"></i>詳細(家計簿)を見る
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<footer th:replace="~{layout/householdFooter::householdFooter}"></footer>
	</div>
	<script th:if="${deposit != null && payment != null}"
		th:inline="javascript">
		const cDeposit = /*[[${depositJs}]]*/"depositJs";
		const cPayment = /*[[${paymentJs}]]*/"paymentJs";
		pieChart();
		subMenu();
		getAnchorValue();
	</script>
	<script th:if="${deposit == null && payment == null}"
		th:inline="javascript">
		pieChartDefault();
		subMenu();
		getAnchorValue();
	</script>
	<script th:src="@{/js/household/calendar.js}"></script>
</body>
</html>